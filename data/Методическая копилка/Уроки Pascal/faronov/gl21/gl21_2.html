<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>
</title>
<meta http-equiv="Content-Type" content="text/html;charset=windows-1251">
</head>
<body BGCOLOR="#E7E3E7" TEXT="#000000" LINK="#004080" VLINK="#004080">

<table COLS="3" width="%">
<tr>
<td>
<font face="Arial, Helvetica, sans-serif">
<a href="gl21_1.html">
<img SRC="Back.gif" BORDER="0"    >
</a>
</font>
</td>
<td width="%">
<font face="Arial, Helvetica, sans-serif">
<a href="../index.html">
<img SRC="Menu.gif" BORDER="0"    >
</a>
</font>
</td>
<td ALIGN="RIGHT">
<font face="Arial, Helvetica, sans-serif">
<a href="gl21_3.html">
<img SRC="For.gif" BORDER="0"    >
</a>
</font>
</td>
</tr>
</table>

<p>
&nbsp;
</p>
<p align="center">
<font face="Arial, Helvetica, sans-serif" size="3">
<b>
<font size="4">

Использование ресурса

</font>
</b>
<br>
</font>
</p>


<P><font face="Arial, Helvetica, sans-serif" size="3">Получить объект из ресурса не представляет проблемы: после инициации файла 
ресурсов Вы просто используете его метод Get, которому передаете ключ (имя) 
нужного ресурса. Например, в следующей программе используется файл Status.res, 
созданный в предыдущем примере:</font> </P>
<P><font face="Verdana, Arial, Helvetica, sans-serif" size="3">Uses Objects, Drivers, Views, Menus, Dialogs, App;</font> </P>
<P><font face="Verdana, Arial, Helvetica, sans-serif" size="3">var</font> </P>
<P><font face="Verdana, Arial, Helvetica, sans-serif" size="3">StatusRes: TResourceFile;  {Файл ресурсов}</font> </P>
<P><font face="Verdana, Arial, Helvetica, sans-serif" size="3">type</font> </P>
<P><font face="Verdana, Arial, Helvetica, sans-serif" size="3">PMyApp =TМуАрр;  {Программа в Turbo Vision}</font> </P>
<P><font face="Verdana, Arial, Helvetica, sans-serif" size="3">ТМуАрр = object (TApplication) Constructor Init;&nbsp;</font> </P>
<P><font face="Verdana, Arial, Helvetica, sans-serif" size="3"> Procedure InitStatusLine; 
Virtual;</font> </P>
<P><font face="Verdana, Arial, Helvetica, sans-serif" size="3">end;</font> </P>
<P><font face="Verdana, Arial, Helvetica, sans-serif" size="3">Constructor TMyApp.Init;&nbsp;</font> </P>
<P><font face="Verdana, Arial, Helvetica, sans-serif" size="3"> {Открывает поток, связанный с файлом ресурсов}</font> </P>
<P><font face="Verdana, Arial, Helvetica, sans-serif" size="3">begin</font> </P>
<P><font face="Verdana, Arial, Helvetica, sans-serif" size="3">StatusRes.Init(New(PBufStream,</font> </P>
<P><font face="Verdana, Arial, Helvetica, sans-serif" size="3">Init('status.res',stOpen,1024)));</font> </P>
<P><font face="Verdana, Arial, Helvetica, sans-serif" size="3">if StatusRes.StreamA.status &lt;&gt; 0 then&nbsp;</font> </P>
<P><font face="Verdana, Arial, Helvetica, sans-serif" size="3">Halt;</font> </P>
<P><font face="Verdana, Arial, Helvetica, sans-serif" size="3">RegisterType(RStatusLine);</font> </P>
<P><font face="Verdana, Arial, Helvetica, sans-serif" size="3">Inherited Init&nbsp;</font> </P>
<P><font face="Verdana, Arial, Helvetica, sans-serif" size="3">end;</font> </P>
<P><font face="Verdana, Arial, Helvetica, sans-serif" size="3">Procedure TMyApp.initStatusLine;&nbsp;</font> </P>
<P><font face="Verdana, Arial, Helvetica, sans-serif" size="3"> {Получает строку статуса из файла ресурсов}&nbsp;</font> </P>
<P><font face="Verdana, Arial, Helvetica, sans-serif" size="3"> 
begin</font> </P>
<P><font face="Verdana, Arial, Helvetica, sans-serif" size="3">StatusLine := PStatusLine(StatusRes.Get('Статус'))&nbsp;</font> </P>
<P><font face="Verdana, Arial, Helvetica, sans-serif" size="3"> end;&nbsp;</font> </P>
<P><font face="Verdana, Arial, Helvetica, sans-serif" size="3"> var</font> </P>
<P><font face="Verdana, Arial, Helvetica, sans-serif" size="3">Prog: TMyApp;</font> </P>
<P><font face="Verdana, Arial, Helvetica, sans-serif" size="3">begin</font> </P>
<P><font face="Verdana, Arial, Helvetica, sans-serif" size="3">Prog.Init;&nbsp;</font> </P>
<P><font face="Verdana, Arial, Helvetica, sans-serif" size="3"> Prog.Run;&nbsp;</font> </P>
<P><font face="Verdana, Arial, Helvetica, sans-serif" size="3"> Prog.Done&nbsp;</font> </P>
<P><font face="Verdana, Arial, Helvetica, sans-serif" size="3"> end.</font> </P>
<P><font face="Arial, Helvetica, sans-serif" size="3">Заметим, что если в файле ресурсов нет ресурса с указанным именем, метод Get 
возвращает значение NIL.</font> </P>
<P><font face="Arial, Helvetica, sans-serif" size="3">Любой ресурс можно получить из файла ресурсов сколько угодно раз и в любом 
порядке, т.е. файл ресурсов - это поток с произвольным доступом. При 
необходимости можно дополнять ранее созданный файл ресурсов новыми объектами или 
заменять существующие в нем объекты другими.</font> </P>
<P><font face="Arial, Helvetica, sans-serif" size="3">Для ускорения доступа к файлу ресурсов его можно связать с EMS-памятью или 
использовать для его размещения виртуальный диск.</font> </P>


<p>
&nbsp;
</p>
<table COLS="3" width="%">
<tr>
<td>
<font face="Arial, Helvetica, sans-serif">
<a href="gl21_1.html">
<img SRC="Back.gif" BORDER="0"    >
</a>
</font>
</td>
<td width="%">
<font face="Arial, Helvetica, sans-serif">
<a href="../index.html">
<img SRC="Menu.gif" BORDER="0"    >
</a>
</font>
</td>
<td ALIGN="RIGHT">
<font face="Arial, Helvetica, sans-serif">
<a href="gl21_3.html">
<img SRC="For.gif" BORDER="0"    >
</a>
</font>
</td>
</tr>
</table>

</BODY></HTML>